<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ColorShop - Meu Perfil</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#fff;--text:#000;--gray:#666;--border:#e5e5e5;--light:#f9fafb;--error:#ef4444;--success:#16a34a;--primary:rgb(201,20,20)}
body{font-family:Inter,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}

/* Header */
.header{position:fixed;top:0;left:0;right:0;z-index:1000;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:16px 5vw}
.header-content{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
.logo{font-size:20px;font-weight:900;letter-spacing:-1px;display:flex;align-items:center;gap:8px;cursor:pointer}
.btn-back{padding:10px 24px;background:var(--text);color:#fff;border:none;border-radius:50px;font-size:12px;font-weight:700;cursor:pointer;transition:all .3s;text-transform:uppercase;letter-spacing:.8px;display:flex;align-items:center;gap:8px}
.btn-back:hover{transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,.2)}

/* Container */
.container{display:flex;min-height:100vh;padding-top:70px}
.profile-side{flex:1;padding:60px 5vw;display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--light);border-right:1px solid var(--border)}
.settings-side{flex:1;padding:60px 5vw;display:flex;flex-direction:column;justify-content:center}

/* Profile Side */
.profile-container{max-width:500px;width:100%;text-align:center}
.avatar-section{margin-bottom:40px}
.avatar-wrapper{position:relative;width:160px;height:160px;margin:0 auto 24px}
.avatar{width:100%;height:100%;border-radius:50%;object-fit:cover;border:4px solid var(--border);background:var(--light)}
.avatar-default{width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,var(--primary),#cc0000);display:flex;align-items:center;justify-content:center;font-size:48px;color:#fff;font-weight:900;border:4px solid var(--border)}
.status-indicator{position:absolute;bottom:8px;right:8px;width:32px;height:32px;border-radius:50%;border:4px solid var(--bg);background:var(--success)}
.status-indicator.offline{background:var(--gray)}
.btn-change-avatar{margin-top:16px;padding:10px 24px;background:var(--text);color:#fff;border:none;border-radius:50px;font-size:12px;font-weight:700;cursor:pointer;transition:all .3s;text-transform:uppercase;letter-spacing:.8px}
.btn-change-avatar:hover{transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,.2)}
.user-name{font-size:32px;font-weight:900;letter-spacing:-1px;margin-bottom:8px}
.user-email{font-size:14px;color:var(--gray);margin-bottom:32px;font-weight:600}
.user-info{background:var(--bg);border:1px solid var(--border);border-radius:16px;padding:32px;text-align:left}
.info-row{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid var(--border)}
.info-row:last-child{border-bottom:none}
.info-label{font-size:12px;text-transform:uppercase;letter-spacing:.8px;color:var(--gray);font-weight:700}
.info-value{font-size:15px;font-weight:600;text-align:right}
.badge{display:inline-block;padding:4px 12px;background:var(--primary);color:#fff;border-radius:12px;font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-left:8px}

/* Settings Side */
.settings-container{max-width:500px;width:100%}
.settings-header{margin-bottom:40px}
.settings-title{font-size:32px;font-weight:900;letter-spacing:-1px;margin-bottom:12px}
.settings-subtitle{font-size:14px;color:var(--gray);font-weight:600}
.settings-section{background:var(--light);border:1px solid var(--border);border-radius:16px;padding:32px;margin-bottom:24px}
.section-title{font-size:16px;font-weight:700;margin-bottom:24px;text-transform:uppercase;letter-spacing:1px}
.form-group{margin-bottom:20px}
.label{display:block;font-size:12px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;margin-bottom:8px;color:var(--gray)}
.input{width:100%;padding:14px 16px;border:1px solid var(--border);border-radius:12px;font-size:14px;font-family:inherit;background:var(--bg);transition:all .3s;font-weight:500}
.input:focus{outline:none;border-color:var(--text);box-shadow:0 0 0 3px rgba(0,0,0,.05)}
.input:disabled{opacity:.6;cursor:not-allowed}
.input-group{position:relative}
.input-icon{position:absolute;right:16px;top:50%;transform:translateY(-50%);color:var(--gray);cursor:pointer;transition:all .3s;font-size:16px}
.input-icon:hover{color:var(--text)}
.btn{width:100%;padding:14px 32px;border:none;border-radius:50px;font-size:12px;font-weight:700;cursor:pointer;transition:all .3s;font-family:inherit;text-transform:uppercase;letter-spacing:.8px;display:flex;align-items:center;justify-content:center;gap:10px}
.btn-primary{background:var(--text);color:#fff}
.btn-primary:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,.2)}
.btn-danger{background:var(--error);color:#fff}
.btn-danger:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 16px rgba(239,68,68,.4)}
.btn:disabled{opacity:.5;cursor:not-allowed}
.danger-zone{background:rgba(239,68,68,.05);border:2px solid rgba(239,68,68,.2);border-radius:16px;padding:32px}
.danger-title{font-size:16px;font-weight:700;margin-bottom:8px;color:var(--error);text-transform:uppercase;letter-spacing:1px}
.danger-desc{font-size:13px;color:var(--gray);margin-bottom:24px;line-height:1.6}
.alert{padding:12px 16px;margin-bottom:20px;border:1px solid;border-radius:12px;font-size:13px;font-weight:600;display:none}
.alert.show{display:block;animation:slideDown .4s}
@keyframes slideDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.alert-error{background:rgba(239,68,68,.1);border-color:var(--error);color:#991b1b}
.alert-success{background:rgba(22,163,74,.1);border-color:var(--success);color:#065f46}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Modal */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:10000;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(5px)}
.modal.active{display:flex;animation:fadeIn .3s}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal-box{background:var(--bg);border-radius:16px;padding:40px;max-width:500px;width:100%;animation:modalUp .4s;position:relative}
@keyframes modalUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
.modal-title{font-size:20px;font-weight:900;letter-spacing:-.5px}
.modal-close{background:none;border:none;font-size:24px;cursor:pointer;color:var(--gray);padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .3s}
.modal-close:hover{background:var(--light);color:var(--text)}
.modal-icon{width:80px;height:80px;background:var(--error);color:#fff;display:flex;align-items:center;justify-content:center;font-size:36px;margin:0 auto 24px;border-radius:50%;box-shadow:0 8px 24px rgba(239,68,68,.3)}
.modal-desc{font-size:14px;color:var(--gray);line-height:1.6;margin-bottom:28px;text-align:center}
.modal-actions{display:flex;gap:12px}
.btn-outline{background:transparent;color:var(--text);border:2px solid var(--border)}
.btn-outline:hover:not(:disabled){background:var(--light);border-color:var(--text)}

/* Avatar Gallery */
.avatar-gallery{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-top:24px;max-height:400px;overflow-y:auto;padding:4px}
.avatar-option{position:relative;aspect-ratio:1;border-radius:12px;overflow:hidden;cursor:pointer;border:3px solid transparent;transition:all .3s}
.avatar-option:hover{border-color:var(--text);transform:scale(1.05)}
.avatar-option.selected{border-color:var(--primary);box-shadow:0 0 0 2px var(--primary)}
.avatar-option img{width:100%;height:100%;object-fit:cover}
.avatar-option-check{position:absolute;top:8px;right:8px;width:24px;height:24px;background:var(--primary);border-radius:50%;display:none;align-items:center;justify-content:center;color:#fff;font-size:12px}
.avatar-option.selected .avatar-option-check{display:flex}
.admin-avatar-section{margin-top:24px;padding-top:24px;border-top:2px solid var(--border)}

@media(max-width:1024px){
.container{flex-direction:column}
.profile-side{border-right:none;border-bottom:1px solid var(--border);padding:40px 20px}
.settings-side{padding:40px 20px}
}
@media(max-width:768px){
.header{padding:12px 20px}
.profile-side,.settings-side{padding:32px 20px}
.avatar-wrapper{width:120px;height:120px}
.user-name{font-size:24px}
.settings-title{font-size:24px}
.avatar-gallery{grid-template-columns:repeat(3,1fr);gap:12px}
}
</style>
</head>
<body>

<header class="header">
<div class="header-content">
<div class="logo" onclick="window.location.href='home.html'">
<i class="fas fa-store"></i>COLORSHOP
</div>
<button class="btn-back" onclick="window.location.href='home.html'">
<i class="fas fa-arrow-left"></i>Voltar
</button>
</div>
</header>

<div class="container">
<!-- Profile Side -->
<div class="profile-side">
<div class="profile-container">
<div class="avatar-section">
<div class="avatar-wrapper">
<div class="avatar-default" id="avatarDisplay">
<i class="fas fa-user"></i>
</div>
<div class="status-indicator" id="statusIndicator"></div>
</div>
<button class="btn-change-avatar" onclick="openAvatarModal()">
<i class="fas fa-camera"></i>Alterar Foto
</button>
</div>

<h1 class="user-name" id="userName">Carregando...</h1>
<p class="user-email" id="userEmail">---</p>

<div class="user-info">
<div class="info-row">
<span class="info-label">Telefone</span>
<span class="info-value" id="userPhone">---</span>
</div>
<div class="info-row">
<span class="info-label">Localização</span>
<span class="info-value" id="userLocation">---</span>
</div>
<div class="info-row">
<span class="info-label">Conta Criada</span>
<span class="info-value" id="userCreated">---</span>
</div>
<div class="info-row">
<span class="info-label">Tipo de Conta</span>
<span class="info-value" id="userType">Usuário<span class="badge" id="adminBadge" style="display:none">ADMIN</span></span>
</div>
</div>
</div>
</div>

<!-- Settings Side -->
<div class="settings-side">
<div class="settings-container">
<div class="settings-header">
<h2 class="settings-title">Configurações</h2>
<p class="settings-subtitle">Gerencie suas informações pessoais e preferências</p>
</div>

<div class="alert" id="alert"></div>

<!-- Personal Info -->
<div class="settings-section">
<h3 class="section-title">Informações Pessoais</h3>
<form id="personalInfoForm">
<div class="form-group">
<label class="label">Nome</label>
<input type="text" class="input" id="firstName" required>
</div>
<div class="form-group">
<label class="label">Sobrenome</label>
<input type="text" class="input" id="lastName" required>
</div>
<div class="form-group">
<label class="label">Telefone</label>
<input type="tel" class="input" id="phone" required>
</div>
<div class="form-group">
<label class="label">Cidade</label>
<input type="text" class="input" id="city" required>
</div>
<div class="form-group">
<label class="label">Estado</label>
<input type="text" class="input" id="state" required maxlength="2">
</div>
<button type="submit" class="btn btn-primary" id="saveInfoBtn">
<i class="fas fa-save"></i>Salvar Alterações
</button>
</form>
</div>

<!-- Change Password -->
<div class="settings-section">
<h3 class="section-title">Alterar Senha</h3>
<form id="passwordForm">
<div class="form-group">
<label class="label">Senha Atual</label>
<div class="input-group">
<input type="password" class="input" id="currentPassword" required>
<i class="fa fa-eye input-icon" onclick="togglePassword('currentPassword')"></i>
</div>
</div>
<div class="form-group">
<label class="label">Nova Senha</label>
<div class="input-group">
<input type="password" class="input" id="newPassword" required>
<i class="fa fa-eye input-icon" onclick="togglePassword('newPassword')"></i>
</div>
</div>
<div class="form-group">
<label class="label">Confirmar Nova Senha</label>
<div class="input-group">
<input type="password" class="input" id="confirmNewPassword" required>
<i class="fa fa-eye input-icon" onclick="togglePassword('confirmNewPassword')"></i>
</div>
</div>
<button type="submit" class="btn btn-primary" id="changePasswordBtn">
<i class="fas fa-key"></i>Alterar Senha
</button>
</form>
</div>

<!-- Danger Zone -->
<div class="danger-zone">
<h3 class="danger-title"><i class="fas fa-exclamation-triangle"></i> Zona de Perigo</h3>
<p class="danger-desc">Ao excluir sua conta, todos os seus dados serão permanentemente removidos e você não poderá mais acessar o sistema.</p>
<button class="btn btn-danger" onclick="openDeleteModal()">
<i class="fas fa-trash"></i>Excluir Conta Permanentemente
</button>
</div>
</div>
</div>
</div>

<!-- Avatar Modal -->
<div class="modal" id="avatarModal">
<div class="modal-box">
<div class="modal-header">
<h3 class="modal-title">Escolher Foto de Perfil</h3>
<button class="modal-close" onclick="closeAvatarModal()">×</button>
</div>
<div class="avatar-gallery" id="avatarGallery">
<div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--gray)">
<i class="fas fa-spinner fa-spin"></i> Carregando fotos...
</div>
</div>
<div class="admin-avatar-section" id="adminAvatarSection" style="display:none">
<div class="form-group">
<label class="label">URL da Imagem (Admin)</label>
<input type="url" class="input" id="customAvatarUrl" placeholder="https://exemplo.com/foto.jpg">
</div>
</div>
<div style="margin-top:24px;display:flex;gap:12px">
<button class="btn btn-outline" onclick="closeAvatarModal()" style="flex:1">Cancelar</button>
<button class="btn btn-primary" onclick="saveAvatar()" style="flex:1"><i class="fas fa-check"></i>Salvar</button>
</div>
</div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal" id="deleteModal">
<div class="modal-box">
<div class="modal-header">
<h3 class="modal-title">Excluir Conta</h3>
<button class="modal-close" onclick="closeDeleteModal()">×</button>
</div>
<div class="modal-icon">
<i class="fas fa-exclamation-triangle"></i>
</div>
<p class="modal-desc">
<strong>Esta ação não pode ser desfeita!</strong><br><br>
Sua conta será marcada como excluída e você não poderá mais fazer login. Todos os seus dados pessoais permanecerão no sistema por questões de auditoria, mas não serão mais acessíveis.
</p>
<div class="form-group">
<label class="label">Digite sua senha para confirmar</label>
<input type="password" class="input" id="deletePassword" placeholder="Sua senha">
</div>
<div class="modal-actions">
<button class="btn btn-outline" onclick="closeDeleteModal()" style="flex:1">Cancelar</button>
<button class="btn btn-danger" onclick="confirmDelete()" id="confirmDeleteBtn" style="flex:1">
<i class="fas fa-trash"></i>Excluir Conta
</button>
</div>
</div>
</div>

<script type="module">
import{initializeApp}from'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import{getFirestore,doc,getDoc,updateDoc,collection,getDocs}from'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
import{getAuth,onAuthStateChanged,updatePassword,EmailAuthProvider,reauthenticateWithCredential,signOut}from'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

const app=initializeApp({apiKey:"AIzaSyCLJ5jo4JknJAe9OlH10EawYEvqjJGnvKg",authDomain:"myfrancashop.firebaseapp.com",projectId:"myfrancashop",storageBucket:"myfrancashop.firebasestorage.app",messagingSenderId:"935759870053",appId:"1:935759870053:web:aabe4af138691d021bee8c"});

const db=getFirestore(app);
const auth=getAuth(app);
let currentUser=null;
let isAdmin=false;
let selectedAvatar='';
let availableAvatars=[];

function sanitize(str){
const div=document.createElement('div');
div.textContent=str;
return div.innerHTML;
}

function showAlert(msg,type='success'){
const alert=document.getElementById('alert');
alert.textContent=msg;
alert.className=`alert show alert-${type}`;
setTimeout(()=>alert.className='alert',5000);
}

function setLoading(btnId,loading,originalText){
const btn=document.getElementById(btnId);
if(!btn)return;
if(loading){
btn.disabled=true;
btn.innerHTML='<span class="spinner"></span>Aguarde...';
}else{
btn.disabled=false;
btn.innerHTML=originalText;
}
}

window.togglePassword=id=>{
const input=document.getElementById(id);
const icon=input.nextElementSibling;
if(input.type==='password'){
input.type='text';
icon.classList.replace('fa-eye','fa-eye-slash');
}else{
input.type='password';
icon.classList.replace('fa-eye-slash','fa-eye');
}
};

async function loadUserData(){
if(!currentUser)return;
try{
const userDoc=await getDoc(doc(db,'users',currentUser.uid));
if(!userDoc.exists()){
showAlert('Dados do usuário não encontrados','error');
return;
}

const userData=userDoc.data();

// Verificar se a conta está excluída
if(userData.deleted){
showAlert('Esta conta foi excluída','error');
await signOut(auth);
setTimeout(()=>window.location.href='login.html',2000);
return;
}

// Avatar
const avatarDisplay=document.getElementById('avatarDisplay');
if(userData.photoURL){
avatarDisplay.innerHTML=`<img src="${userData.photoURL}" class="avatar" alt="Avatar">`;
}else{
const initials=`${(userData.name||'')[0]||''}${(userData.lastName||'')[0]||''}`.toUpperCase();
avatarDisplay.innerHTML=initials||'<i class="fas fa-user"></i>';
}

// Status online (sempre online quando acessando a página)
document.getElementById('statusIndicator').className='status-indicator';

// Informações principais
const fullName=`${userData.name||''} ${userData.lastName||''}`.trim()||'Usuário';
document.getElementById('userName').textContent=fullName;
document.getElementById('userEmail').textContent=currentUser.email;
document.getElementById('userPhone').textContent=formatPhone(userData.phone)||'Não informado';
document.getElementById('userLocation').textContent=
userData.city&&userData.state?`${userData.city}, ${userData.state}`:'Não informado';

// Data de criação
const createdDate=userData.createdAt?.toDate?userData.createdAt.toDate():new Date();
document.getElementById('userCreated').textContent=formatDate(createdDate);

// Tipo de conta
if(isAdmin){
document.getElementById('adminBadge').style.display='inline-block';
}

// Preencher formulários
document.getElementById('firstName').value=userData.name||'';
document.getElementById('lastName').value=userData.lastName||'';
document.getElementById('phone').value=userData.phone||'';
document.getElementById('city').value=userData.city||'';
document.getElementById('state').value=userData.state||'';

selectedAvatar=userData.photoURL||'';
}catch(e){
console.error('Erro ao carregar dados:',e);
showAlert('Erro ao carregar dados do usuário','error');
}
}

function formatPhone(phone){
if(!phone)return'';
const cleaned=phone.replace(/\D/g,'');
if(cleaned.length===11){
return`(${cleaned.slice(0,2)}) ${cleaned.slice(2,7)}-${cleaned.slice(7)}`;
}
return phone;
}

function formatDate(date){
return new Intl.DateTimeFormat('pt-BR',{
day:'2-digit',
month:'long',
year:'numeric'
}).format(date);
}

// Personal Info Form
document.getElementById('personalInfoForm').addEventListener('submit',async(e)=>{
e.preventDefault();
const firstName=sanitize(document.getElementById('firstName').value.trim());
const lastName=sanitize(document.getElementById('lastName').value.trim());
const phone=document.getElementById('phone').value.trim().replace(/\D/g,'');
const city=sanitize(document.getElementById('city').value.trim());
const state=sanitize(document.getElementById('state').value.trim().toUpperCase());

if(!firstName||!lastName||!phone||!city||!state){
showAlert('Preencha todos os campos','error');
return;
}

setLoading('saveInfoBtn',true,'<i class="fas fa-save"></i>Salvar Alterações');
try{
await updateDoc(doc(db,'users',currentUser.uid),{
name:firstName,
lastName:lastName,
phone:phone,
city:city,
state:state,
updatedAt:new Date()
});
showAlert('Informações atualizadas com sucesso!','success');
loadUserData();
}catch(e){
console.error('Erro:',e);
showAlert('Erro ao atualizar informações','error');
}finally{
setLoading('saveInfoBtn',false,'<i class="fas fa-save"></i>Salvar Alterações');
}
});

// Change Password Form
document.getElementById('passwordForm').addEventListener('submit',async(e)=>{
e.preventDefault();
const currentPassword=document.getElementById('currentPassword').value;
const newPassword=document.getElementById('newPassword').value;
const confirmPassword=document.getElementById('confirmNewPassword').value;

if(newPassword!==confirmPassword){
showAlert('As senhas não coincidem','error');
return;
}

if(newPassword.length<6){
showAlert('A nova senha deve ter no mínimo 6 caracteres','error');
return;
}

setLoading('changePasswordBtn',true,'<i class="fas fa-key"></i>Alterar Senha');
try{
const credential=EmailAuthProvider.credential(currentUser.email,currentPassword);
await reauthenticateWithCredential(currentUser,credential);
await updatePassword(currentUser,newPassword);
showAlert('Senha alterada com sucesso!','success');
document.getElementById('passwordForm').reset();
}catch(e){
console.error('Erro:',e);
let msg='Erro ao alterar senha';
if(e.code==='auth/wrong-password')msg='Senha atual incorreta';
else if(e.code==='auth/weak-password')msg='Nova senha muito fraca';
showAlert(msg,'error');
}finally{
setLoading('changePasswordBtn',false,'<i class="fas fa-key"></i>Alterar Senha');
}
});

// Avatar Modal
window.openAvatarModal=async()=>{
document.getElementById('avatarModal').classList.add('active');
if(isAdmin){
document.getElementById('adminAvatarSection').style.display='block';
document.getElementById('customAvatarUrl').value=selectedAvatar||'';
}
await loadAvatarGallery();
};

window.closeAvatarModal=()=>{
document.getElementById('avatarModal').classList.remove('active');
};

async function loadAvatarGallery(){
const gallery=document.getElementById('avatarGallery');
try{
const snap=await getDocs(collection(db,'avatars'));
availableAvatars=[];
snap.forEach(doc=>{
const data=doc.data();
if(data.url)availableAvatars.push(data.url);
});

if(availableAvatars.length===0){
gallery.innerHTML='<div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--gray)">Nenhuma foto disponível</div>';
return;
}

gallery.innerHTML=availableAvatars.map(url=>{
const isSelected=url===selectedAvatar;
return`
<div class="avatar-option ${isSelected?'selected':''}" onclick="selectAvatar('${url}')">
<img src="${url}" alt="Avatar">
<div class="avatar-option-check"><i class="fas fa-check"></i></div>
</div>
`;
}).join('');
}catch(e){
console.error('Erro ao carregar avatares:',e);
gallery.innerHTML='<div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--error)">